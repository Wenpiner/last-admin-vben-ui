# LastAdminCaptcha 多语言配置

## 概述

为了避免与上游仓库同步时出现冲突，LastAdminCaptcha 组件的翻译文件独立存放在 `lastAdmin.json` 中，而不是添加到 `ui.json` 中。

## 翻译文件结构

```
packages/locales/src/langs/
├── zh-CN/
│   └── lastAdmin.json    # 中文翻译（包含 lastAdmin 相关的所有翻译）
└── en-US/
    └── lastAdmin.json    # 英文翻译（包含 lastAdmin 相关的所有翻译）
```

## 翻译文件内容

### 中文翻译 (zh-CN/lastAdmin.json)

```json
{
  "captcha": {
    "inputPlaceholder": "请输入验证码",
    "loading": "加载中...",
    "refresh": "刷新"
  }
}
```

### 英文翻译 (en-US/lastAdmin.json)

```json
{
  "captcha": {
    "inputPlaceholder": "Please enter captcha",
    "loading": "Loading...",
    "refresh": "Refresh"
  }
}
```

## 翻译键说明

| 键 | 中文 | 英文 | 用途 |
| --- | --- | --- | --- |
| `lastAdmin.captcha.inputPlaceholder` | 请输入验证码 | Please enter captcha | 输入框占位符 |
| `lastAdmin.captcha.loading` | 加载中... | Loading... | 验证码加载状态提示 |
| `lastAdmin.captcha.refresh` | 刷新 | Refresh | 刷新按钮 aria-label |

## 组件中的使用

```vue
<script setup lang="ts">
import { $t } from '@vben/locales';
</script>

<template>
  <!-- 输入框占位符 -->
  <VbenInput
    :placeholder="placeholder || $t('lastAdmin.captcha.inputPlaceholder')"
  />

  <!-- 加载状态提示 -->
  <div v-else class="text-foreground/50 text-xs">
    {{ $t('lastAdmin.captcha.loading') }}
  </div>

  <!-- 刷新按钮 -->
  <VbenIconButton :aria-label="$t('lastAdmin.captcha.refresh')">
    <RotateCw />
  </VbenIconButton>
</template>
```

## 自动加载机制

i18n 系统会自动加载 `packages/locales/src/langs/**/*.json` 下的所有文件：

```typescript
// packages/locales/src/i18n.ts
const modules = import.meta.glob('./langs/**/*.json');

const localesMap = loadLocalesMapFromDir(
  /\.\/langs\/([^/]+)\/(.*)\.json$/,
  modules,
);
```

**关键点**：文件名（不含 `.json` 扩展名）会直接作为翻译的命名空间键。

例如：

- `zh-CN/lastAdmin.json` → `messages['lastAdmin']` → 访问键为 `lastAdmin.captcha.inputPlaceholder`
- `en-US/lastAdmin.json` → `messages['lastAdmin']` → 访问键为 `lastAdmin.captcha.inputPlaceholder`

文件内容结构：

```
lastAdmin.json (文件名作为命名空间)
└── captcha (文件内的块)
    ├── inputPlaceholder
    ├── loading
    └── refresh
```

因此，`lastAdmin.json` 文件会被自动加载，无需额外配置。

## 优势

### 1. 避免上游冲突

- ✅ 独立的翻译文件不会与 `ui.json` 冲突
- ✅ 上游更新 `ui.json` 时不会影响本组件
- ✅ 本地修改不会影响上游

### 2. 易于维护

- ✅ 组件相关的翻译集中在一个文件中
- ✅ 易于查找和修改
- ✅ 清晰的文件结构

### 3. 易于扩展

- ✅ 添加新语言只需创建新的翻译文件
- ✅ 无需修改现有文件
- ✅ 自动加载机制确保新文件被识别

## 添加新语言

如需添加新语言支持（例如日语），只需创建对应的翻译文件：

```json
// packages/locales/src/langs/ja-JP/lastAdmin.json
{
  "captcha": {
    "inputPlaceholder": "認証コードを入力してください",
    "loading": "読み込み中...",
    "refresh": "更新"
  }
}
```

组件会自动使用新添加的翻译。

## 相关文件

- `packages/effects/common-ui/src/components/captcha/last-admin-captcha/index.vue` - 组件实现
- `packages/locales/src/langs/zh-CN/lastAdmin.json` - 中文翻译
- `packages/locales/src/langs/en-US/lastAdmin.json` - 英文翻译
- `packages/locales/src/i18n.ts` - i18n 配置

## 注意事项

1. **文件命名**：使用 `lastAdmin.json` 作为文件名（不使用连字符），因为文件名会直接作为翻译的命名空间键
2. **文件内容结构**：文件内容只需包含块名称（如 `captcha`），不需要再嵌套文件名
3. **翻译键访问**：使用 `lastAdmin.captcha.*` 访问翻译（文件名 + 文件内块名 + 键名）
4. **文件位置**：翻译文件必须放在 `packages/locales/src/langs/[lang]/` 目录下
5. **文件格式**：必须是有效的 JSON 格式
6. **自动加载**：无需手动注册，i18n 系统会自动加载所有 `*.json` 文件
7. **可扩展性**：可以在 `lastAdmin.json` 中添加其他块，例如 `form`, `table` 等，访问方式为 `lastAdmin.form.*`, `lastAdmin.table.*`
